import{j as n,u as S,b as u,U as E,R as B,d as N,B as L,I as M,e as $,L as H,H as z,g as T,h as I,Q as K,i as D,M as P}from"./vendor-DWb21r7D.js";import{B as p}from"./shared-components-E8G5ZYNI.js";const U=t=>{const e=t.split(`
`),s=[];let r=0;return e.forEach((l,a)=>{const c=l.length+1,o=l.trim();let i={id:`block-${a}`,type:"paragraph",startOffset:r,endOffset:r+c-1,content:l};const g=o.match(/^(#{1,6})\s/);g?(i.type="heading",i.level=g[1].length):o.startsWith("```")?i.type="code":o.startsWith(">")?i.type="quote":o.match(/^[-*+]\s/)||o.match(/^\d+\.\s/)?i.type="list":o.match(/^!\[.*\]\(.*\)/)&&(i.type="image"),s.push(i),r+=c}),s},O=(t,e)=>t.find(s=>e>=s.startOffset&&e<=s.endOffset)||null,w=(t,e,s,r=s)=>{const{start:l,end:a}=e,c=t.slice(l,a);return{content:t.slice(0,l)+s+c+r+t.slice(a),selection:{start:l+s.length,end:a+s.length}}},j=(t,e,s)=>{const r=t.split(`
`);let l=0,a=0;for(let o=0;o<r.length;o++){const i=r[o].length+1;if(e.start<l+i){a=o;break}l+=i}return r[a]=r[a].replace(/^#{1,6}\s|^>\s|^[-*+]\s|^\d+\.\s/,""),s&&(r[a]=s+" "+r[a]),{content:r.join(`
`),selection:{...e}}},R=()=>[{id:"bold",label:"Bold",icon:n.jsx(L,{}),shortcut:"⌘B",handler:(t,e)=>w(t,e,"**")},{id:"italic",label:"Italic",icon:n.jsx(M,{}),shortcut:"⌘I",handler:(t,e)=>w(t,e,"_")},{id:"code",label:"Inline Code",icon:n.jsx($,{}),handler:(t,e)=>w(t,e,"`")},{id:"link",label:"Link",icon:n.jsx(H,{}),shortcut:"⌘K",handler:(t,e)=>{const s=t.slice(e.start,e.end)||"link text",r=`[${s}](url)`;return{content:t.slice(0,e.start)+r+t.slice(e.end),selection:{start:e.start+s.length+3,end:e.start+s.length+6}}}},{id:"h1",label:"Heading 1",icon:n.jsx(z,{}),handler:(t,e)=>j(t,e,"#")},{id:"h2",label:"Heading 2",icon:n.jsx(T,{}),handler:(t,e)=>j(t,e,"##")},{id:"h3",label:"Heading 3",icon:n.jsx(I,{}),handler:(t,e)=>j(t,e,"###")},{id:"quote",label:"Quote",icon:n.jsx(K,{}),handler:(t,e)=>j(t,e,">")},{id:"code-block",label:"Code Block",icon:n.jsx(D,{}),handler:(t,e)=>w(t,e,"```\n","\n```")}],q=(t="")=>{const[e,s]=u.useState(t),[r,l]=u.useState({start:0,end:0}),[a,c]=u.useState([t]),[o,i]=u.useState(0),g=u.useMemo(()=>U(e),[e]),h=u.useMemo(()=>O(g,r.start),[g,r]),x=u.useCallback((d,y)=>{s(d),y&&l(y),c(m=>[...m.slice(0,o+1),d]),i(m=>m+1)},[o]),b=u.useCallback(()=>{o>0&&(i(d=>d-1),s(a[o-1]))},[a,o]),k=u.useCallback(()=>{o<a.length-1&&(i(d=>d+1),s(a[o+1]))},[a,o]);return{content:e,selection:r,blocks:g,currentBlock:h,updateContent:x,setSelection:l,undo:b,redo:k,canUndo:o>0,canRedo:o<a.length-1}},A=(t,e)=>{u.useEffect(()=>{const s=t?.current;if(!s)return;const r=l=>{const{value:a,selectionStart:c,selectionEnd:o}=s,i={start:c||0,end:o||0};if(l.key===" "){const h=a.split(`
`);let x=0,b="";for(const d of h){if(c<=x+d.length){b=d;break}x+=d.length+1}const k={"#":"# ","##":"## ","###":"### ","-":"- ",">":"> ","```":"```\n"};for(const[d,y]of Object.entries(k))if(b.trimStart()===d){l.preventDefault();const m=j(a,i,y.trim());e(m.content,m.selection);return}}const g={"**":"**",_:"_","`":"`","[":"]","(":")","{":"}",'"':'"',"'":"'"};if(g[l.key]&&c===o){l.preventDefault();const h=a.slice(0,c),x=a.slice(c),b=h+l.key+g[l.key]+x;e(b,{start:c+l.key.length,end:c+l.key.length});return}if(l.key==="Tab"){l.preventDefault();const h=a.slice(0,c),x=a.slice(o),b=h+"  "+x;e(b,{start:c+2,end:c+2})}};return s.addEventListener("keydown",r),()=>s.removeEventListener("keydown",r)},[t,e])},F=({actions:t,onAction:e,currentBlock:s})=>n.jsxs("div",{className:"flex items-center gap-2 h-[50px] px-2 py-3 bg-background border-b border-border",children:[n.jsx("div",{className:"flex items-center gap-1",children:t.slice(0,4).map(r=>n.jsx(p,{onClick:()=>e(r),size:"icon",variant:"outline",className:"text-foreground/70",title:`${r.label}${r.shortcut?` (${r.shortcut})`:""}`,children:r.icon},r.id))}),n.jsx("div",{className:"w-px h-6 bg-border"}),n.jsx("div",{className:"flex items-center gap-1",children:t.slice(4).map(r=>n.jsx(p,{onClick:()=>e(r),size:"icon",variant:"outline",className:"text-foreground/70",title:r.label,children:r.icon},r.id))})]}),Q=({content:t,onChange:e,onSelectionChange:s,textareaRef:r,placeholder:l})=>{const a=o=>{e(o.target.value)},c=()=>{r.current&&s({start:r.current.selectionStart,end:r.current.selectionEnd})};return n.jsx("div",{className:"flex flex-col flex-1 border-r border-border",children:n.jsx("textarea",{ref:r,value:t,onChange:a,onSelect:c,onClick:c,onKeyUp:c,placeholder:l||"Start writing your markdown...",spellCheck:!1,className:"flex-1 p-8 bg-muted text-foreground border-0 font-mono text-[15px] leading-relaxed resize-none outline-none placeholder:text-zinc-600"})})},W=({content:t})=>n.jsx("div",{className:"flex-1 overflow-y-auto bg-muted/30",children:n.jsx("div",{className:"p-8 max-w-3xl mx-auto",children:t?n.jsx(P,{content:t,className:""}):n.jsx("p",{className:"text-muted-foreground text-center mt-24 italic",children:"Preview will appear here..."})})}),_=()=>{const{isDark:t,setTheme:e}=S(),[s,r]=u.useState("split"),[l,a]=u.useState(!1),c=u.useRef(null),o=u.useMemo(()=>R(),[]),{content:i,selection:g,currentBlock:h,updateContent:x,setSelection:b,undo:k,redo:d,canUndo:y,canRedo:m}=q(`# Welcome to the Editor

Start writing your **markdown** content here.

## Features

- Live preview
- Keyboard shortcuts
- Block-based editing
- Extensible architecture

\`\`\`javascript
const editor = new MarkdownEditor();
\`\`\`

> This is a quote block

Happy writing! ✨`);A(c,x);const C=u.useCallback(v=>{const f=v.handler(i,g);x(f.content,f.selection),setTimeout(()=>{c.current&&(c.current.focus(),c.current.setSelectionRange(f.selection.start,f.selection.end))},0)},[i,g,x]);return u.useEffect(()=>{const v=f=>{(f.metaKey||f.ctrlKey)&&f.key==="z"&&(f.preventDefault(),f.shiftKey?d():k())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[k,d]),n.jsxs("div",{className:`flex flex-col h-screen bg-background ${l?"fixed inset-0 z-[9999]":""}`,children:[n.jsxs("div",{className:"flex justify-between items-center h-[50px] px-2 py-4 bg-background border-b border-b-border",children:[n.jsx("div",{className:"text-lg font-semibold text-foreground flex items-center gap-4",children:n.jsx("span",{children:"Nindo"})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(p,{onClick:()=>r("edit"),className:`px-4 py-1.5 border rounded-md transition-all text-sm ${s==="edit"?"bg-primary border-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent hover:border-accent"}`,children:"Edit"}),n.jsx(p,{onClick:()=>r("split"),className:`px-4 py-1.5 border rounded-md transition-all text-sm ${s==="split"?"bg-primary border-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent hover:border-accent"}`,children:"Split"}),n.jsx(p,{variant:"outline",onClick:()=>r("preview"),className:`px-4 py-1.5 rounded-md border transition-all text-sm ${s==="preview"?"bg-primary border-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent hover:border-accent"}`,children:"Preview"}),n.jsx("div",{className:"w-px h-6 bg-border mx-1"}),n.jsx(p,{onClick:k,disabled:!y,size:"icon",variant:"ghost",className:"text-foreground/70",title:"Undo (⌘Z)",children:n.jsx(E,{})}),n.jsx(p,{onClick:d,disabled:!m,size:"icon",variant:"ghost",className:"text-foreground/70",title:"Redo (⌘⇧Z)",children:n.jsx(B,{})}),n.jsx(p,{size:"icon",variant:"ghost",className:"text-foreground/70",onClick:()=>e(t?"light":"dark"),children:t?n.jsx(N,{className:"rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100 opacity-0 dark:opacity-100"}):n.jsx(N,{className:"rotate-0 scale-100 transition-all dark:rotate-90 dark:scale-0 opacity-100 dark:opacity-0"})})]})]}),n.jsx(F,{actions:o,onAction:C,currentBlock:h}),n.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[(s==="edit"||s==="split")&&n.jsx(Q,{content:i,onChange:x,onSelectionChange:b,textareaRef:c}),(s==="preview"||s==="split")&&n.jsx(W,{content:i})]}),n.jsxs("div",{className:"flex justify-end gap-6 px-6 py-2 bg-background border-t border-border text-xs text-zinc-500",children:[n.jsx("span",{className:"flex items-center",children:h?`${h.type}${h.level?` (H${h.level})`:""}`:"paragraph"}),n.jsxs("span",{className:"flex items-center",children:[i.split(`
`).length," lines · ",i.length," chars"]})]})]})},Z=()=>n.jsx("section",{className:"bg-background w-full h-full",children:n.jsx(_,{})});Z.metadata={title:"Blog",description:"Blog page"};export{Z as default};
